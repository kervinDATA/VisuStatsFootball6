<div class="controls">
  <!-- Message d'avertissement si la limite est atteinte -->
  <div *ngIf="charts.length >= 5" class="warning">
    <p>Limite atteinte : Vous ne pouvez pas ajouter plus de 5 graphiques.</p>
  </div>
  <!-- Bouton pour ajouter un graphique -->
  <button (click)="addChart()">Ajouter un graphique</button>
  <!-- Formulaire pour sauvegarder les graphiques -->
  <div class="save-analysis">
    <label for="analysis-name">Nom de l’analyse :</label>
    <input type="text" [(ngModel)]="analysisName" placeholder="Nom de l'analyse" />

    <button (click)="saveCurrentAnalysis()">Sauvegarder les graphiques actuels</button>
  </div>
</div>

<!-- Bloc pour modifier une analyse existante -->
<div class="edit-analysis">
  <label for="edit-analysis-name">Modifier le nom de l’analyse :</label>
  <input type="text" [(ngModel)]="analysisName" placeholder="Nom de l'analyse" />
</div>

<!-- Affichage des graphiques -->
<div class="charts">
  <div *ngFor="let chart of charts; let i = index" class="chart-container">
    <!-- Filtres pour chaque graphique -->
    <div class="filters">
      <label for="season">Saison :</label>
      <select [(ngModel)]="chart.selectedSeason" (change)="updateChart(i)">
        <option *ngFor="let season of seasons" [value]="season">{{ season }}</option>
      </select>

      <label for="statType">Type de statistique :</label>
      <select [(ngModel)]="chart.selectedStatType" (change)="updateChart(i)">
        <option *ngFor="let type of statTypes" [value]="type.route">{{ type.label }}</option>
      </select>
    </div>

    <!-- Graphique -->
    <div *ngIf="!chart.chartData">
      <p>Sélectionnez une saison et un type de statistique pour afficher un graphique.</p>
    </div>
    <div *ngIf="chart.chartData">
      <apx-chart
        [series]="chart.chartData.series"
        [chart]="chart.chartData.chart"
        [xaxis]="chart.chartData.xaxis"
        [plotOptions]="chart.chartData.plotOptions"
        [yaxis]="chart.chartData.yaxis"
      ></apx-chart>
    </div>

    <!-- Bouton pour supprimer le graphique -->
    <button (click)="removeChart(i)">Supprimer ce graphique</button>
  </div>
</div>

<!-- Liste des analyses sauvegardées -->
<div class="saved-analyses">
  <h3>Analyses sauvegardées</h3>
  <div *ngIf="savedAnalyses.length === 0">
    <p>Aucune analyse sauvegardée pour le moment.</p>
  </div>
  <ul *ngIf="savedAnalyses.length > 0">
    <li *ngFor="let analysis of savedAnalyses">
      <span>{{ analysis.name }}</span>
      <button (click)="loadAnalysis(analysis)">Charger</button>
      <button (click)="editAnalysis(analysis)">Modifier</button>
      <button (click)="deleteAnalysis(analysis.id)">Supprimer</button>
    </li>
  </ul>
</div>

